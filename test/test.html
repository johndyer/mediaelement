<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>HTML5 MediaElement</title>

	<!--[if lte IE 8]>
	<script src="../src/js/console.js"></script>
	<![endif]-->

	<script src="../build/jquery.js"></script>

	<script src="../src/js/mediaelement-header.js"></script>
	<script src="../src/js/mediaelement-namespace.js"></script>
	<script src="../src/js/mediaelement-utility.js"></script>
	<script src="../src/js/mediaelement-utility-oldie.js"></script>
	<script src="../src/js/mediaelement-core.js"></script>
	<script src="../src/js/mediaelement-renderer-html5.js"></script>
	<script src="../src/js/mediaelement-renderer-mdash.js"></script>
	<script src="../src/js/mediaelement-renderer-hls.js"></script>
	<script src="../src/js/mediaelement-renderer-youtube-iframe.js"></script>
	<script src="../src/js/mediaelement-renderer-vimeo.js"></script>
	<script src="../src/js/mediaelement-renderer-dailymotion-iframe.js"></script>
	<script src="../src/js/mediaelement-renderer-facebook.js"></script>
	<script src="../src/js/mediaelement-renderer-soundcloud.js"></script>
	<script src="../src/js/mediaelement-renderer-flash.js"></script>

	<script src="../src/js/mediaelementplayer-library.js"></script>
	<script src="../src/js/mediaelement-i18n.js"></script>
	<script src="../src/js/mediaelement-i18n-locale-en.js"></script>
	<script src="../src/js/mediaelementplayer-player.js"></script>
	<script src="../src/js/mediaelementplayer-feature-playpause.js"></script>
	<script src="../src/js/mediaelementplayer-feature-progress.js"></script>
	<script src="../src/js/mediaelementplayer-feature-time.js"></script>
	<script src="../src/js/mediaelementplayer-feature-speed.js"></script>
	<script src="../src/js/mediaelementplayer-feature-tracks.js"></script>
	<script src="../src/js/mediaelementplayer-feature-volume.js"></script>
	<script src="../src/js/mediaelementplayer-feature-stop.js"></script>
	<script src="../src/js/mediaelementplayer-feature-skipback.js"></script>
	<script src="../src/js/mediaelementplayer-feature-sourcechooser.js"></script>
	<script src="../src/js/mediaelementplayer-feature-fullscreen.js"></script>
	<script src="../src/js/mediaelementplayer-feature-jumpforward.js"></script>
	<script src="../src/js/mediaelementplayer-feature-loop.js"></script>
	<script src="../src/js/mediaelementplayer-feature-markers.js"></script>

	<link rel="stylesheet" href="../src/css/mediaelementplayer.css">

	<style>
	#container{
		width: 700px;
		margin: 20px auto;
	}
	</style>
</head>
<body>

	<div id="container">

	<h1>MediaElementPlayer.js</h1>

	<p>Recommended Setup</p>

	<form>

			<h2>MP4/WebM</h2>

			<div id="video-container">
				<video width="640" height="360" id="player1" controls="controls" preload="none">
					<source src="http://clips.vorwaerts-gmbh.de/big_buck_bunny.mp4"  type="video/mp4">
					<source src="https://upload.wikimedia.org/wikipedia/commons/2/22/Volcano_Lava_Sample.webm"  type="video/webm">
					<track srclang="en" kind="subtitles" type="text/vtt" src="files/mediaelement.vtt">
				</video>
			</div>

			<input id="showit" type="button" value="show it"><br>

			<span id="video-mode"></span>
			<div style="min-height: 400px">
				<div id="video-events"></div>
				<div id="video-props"></div>
			</div>

			<h2>YouTube</h2>

			<video width="640" height="360" class="mejs-player" id="player3" preload="none" controls>
				<source src="https://www.youtube.com/watch?v=C0DPdy98e4c"  type="video/youtube">
			</video>

			<h2>MP3 audio (as src)</h2>

			<audio id="player2" preload="none" controls="controls">
				<source src="http://www.stephaniequinn.com/Music/Commercial%20DEMO%20-%2010.mp3" type="audio/mp3">
			</audio>

			<span id="audio-mode"></span>
		</form>
	</div>

	<script>
	function appendMediaEvents($node, media) {
		var
			mediaEventNames = 'loadstart progress suspend abort error emptied stalled play pause loadedmetadata loadeddata waiting playing canplay canplaythrough seeking seeked timeupdate ended ratechange durationchange volumechange'.split(' ');
			mediaEventTable = $('<table class="media-events"><caption>Media Events</caption><tbody></tbody></table>').appendTo($node).find('tbody'),
			tr = null,
			th = null,
			td = null,
			eventName = null,
			il = 0,
			i=0;

		for (il = mediaEventNames.length;i<il;i++) {
			eventName = mediaEventNames[i];
			th = $('<th>' + eventName + '</th>');
			td = $('<td id="e_' + media.id + '_' + eventName + '" class="not-fired">0</td>');

			if (tr == null)
				tr = $("<tr/>");

			tr.append(th);
			tr.append(td);

			if ((i+1) % 5 == 0) {
				mediaEventTable.append(tr);
				tr = null;
			}

			// listen for event
			media.addEventListener(eventName, function(e) {

				var notice = $('#e_' + media.id + '_' + e.type),
					number = parseInt(notice.html(), 10);

				notice
					.html(number+1)
					.attr('class','fired');
			}, true);
		}

		mediaEventTable.append(tr);
	}

	function appendMediaProperties($node, media) {
		var /* src currentSrc  */
			mediaPropertyNames = 'error currentSrc networkState preload buffered bufferedBytes bufferedTime readyState seeking currentTime initialTime duration startOffsetTime paused defaultPlaybackRate playbackRate played seekable ended autoplay loop controls volume muted'.split(' '),
			mediaPropertyTable = $('<table class="media-properties"><caption>Media Properties</caption><tbody></tbody></table>').appendTo($node).find('tbody'),
			tr = null,
			th = null,
			td = null,
			propName = null,
			il = 0,
			i=0;

		for (il = mediaPropertyNames.length; i<il; i++) {
			propName = mediaPropertyNames[i];
			th = $('<th>' + propName + '</th>');
			td = $('<td id="p_' + media.id + '_' + propName + '" class=""></td>');

			if (tr == null)
				tr = $("<tr/>");

			tr.append(th);
			tr.append(td);

			if ((i+1) % 3 == 0) {
				mediaPropertyTable.append(tr);
				tr = null;
			}
		}

		setInterval(function() {
			var
				propName = '',
				val = null,
				td = null;

			for (i = 0, il = mediaPropertyNames.length; i<il; i++) {
				propName = mediaPropertyNames[i];
				td = $('#p_' + media.id + '_' + propName);
				val = media[propName];
				val =
					(typeof val == 'undefined') ?
					'undefined' : (val == null) ? 'null' : val.toString();
				td.html(val);
			}
		}, 500);

	}

	$('audio, video').bind('error', function(e) {

		//console.log('error',this, e, this.src, this.error.code);
	});

	$(document).ready(function() {

		$('#showit').on('click', function() {
			if ($('#video-container').is(':visible')) {
				$('#video-container').hide();
			} else {
				$('#video-container').show();
			}
		});

		$('audio, video').mediaelementplayer({
			pluginPath:'../build/',
			markers: [2.5, 10, 35, 40.2],
			features: ['playpause', 'current', 'progress','volume','speed', 'duration', 'fullscreen', 'tracks', 'skipback', 'jumpforward', 'loop', 'markers', 'stop', 'sourcechooser'],
			success: function(me, node) {
				// report type
				var tagName = node.tagName.toLowerCase();

				if (tagName === 'video') {
					appendMediaProperties($('#' + tagName + '-props'), me);
					appendMediaEvents($('#' + tagName + '-events'), me);

				}
			}
		});
	});

	</script>

</body>
</html>
