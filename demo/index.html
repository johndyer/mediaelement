<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>MediaElement.js 3.0 - audio/video unification library</title>

    <!--[if lte IE 8]>
    <script src="../src/js/console.js"></script>
    <![endif]-->

    <script src="../build/jquery.js"></script>

    <script src="../build/mediaelement-and-player.min.js"></script>
    <script src="../build/lang/mediaelement-i18n-locale-cs.js"></script>
    <script src="../build/lang/mediaelement-i18n-locale-de.js"></script>
    <script src="../build/lang/mediaelement-i18n-locale-en.js"></script>
    <script src="../build/lang/mediaelement-i18n-locale-es.js"></script>
    <script src="../build/lang/mediaelement-i18n-locale-fr.js"></script>
    <script src="../build/lang/mediaelement-i18n-locale-hu.js"></script>
    <script src="../build/lang/mediaelement-i18n-locale-it.js"></script>
    <script src="../build/lang/mediaelement-i18n-locale-ja.js"></script>
    <script src="../build/lang/mediaelement-i18n-locale-ko.js"></script>
    <script src="../build/lang/mediaelement-i18n-locale-nl.js"></script>
    <script src="../build/lang/mediaelement-i18n-locale-pl.js"></script>
    <script src="../build/lang/mediaelement-i18n-locale-pt.js"></script>
    <script src="../build/lang/mediaelement-i18n-locale-pt-br.js"></script>
    <script src="../build/lang/mediaelement-i18n-locale-ro.js"></script>
    <script src="../build/lang/mediaelement-i18n-locale-ru.js"></script>
    <script src="../build/lang/mediaelement-i18n-locale-sk.js"></script>
    <script src="../build/lang/mediaelement-i18n-locale-zh-cn.js"></script>
    <script src="../build/lang/mediaelement-i18n-locale-zh.js"></script>

    <link rel="stylesheet" href="../build/mediaelementplayer.min.css">

    <style>

        .commands {
            padding: 0 0 50px 0;
        }
        .commands > .command {
            display: block;
            margin: 2px;
            cursor: pointer;
        }
        .commands > .command:hover {
            background-color: #eaedb8;
        }

    </style>
</head>

<body>

<div id="container">

    <h1>MediaElement.js</h1>

    <h2>audio/video unification library</h2>

    <p><em>MediaElement</em> is a wrapper that mimics the native HTML5 MediaElement syntax (get/set) as a renderer that can handle media from HTML5, YouTube, Vimeo, Soundcloud, Flash, JSMad, and other libraries.</p>

    <p><em>MediaElementPlayer</em> is built off of MediaElement and creates a fully featured player on top of the unified syntax from MediaElement.</p>


    <div class="players" id="player1-container">

        <h3>Video Player</h3>

        <div class="media-wrapper">
            <video id="player1" width="640" height="360" style="max-width:100%; max-height:100%;" preload="none" >
                <source src="http://clips.vorwaerts-gmbh.de/big_buck_bunny.mp4" type="video/mp4">
            </video>
        </div>
        <br>

        <div>
            <form action="#" method="get">
                <label>Language <select name="lang">
                    <option value="cs">Čeština / Czech (cs)</option>
                    <option value="de">Deutsch / German (de)</option>
                    <option value="en" selected>English (en)</option>
                    <option value="es">Español / Spanish; Castilian (es)</option>
                    <option value="fr">Français / French (fr)</option>
                    <option value="hu">Magyar / Hungarian (hu)</option>
                    <option value="it">Italiano / Italian (it)</option>
                    <option value="ja">日本語 / Japanese (ja)</option>
                    <option value="ko">한국어 / Korean (ko)</option>
                    <option value="nl">Nederlands / Dutch (nl)</option>
                    <option value="pl">Polski / Polish (pl)</option>
                    <option value="pt">Português / Portuguese (pt)</option>
                    <option value="pt-BR">Português / Brazilian Portuguese (pt-BR)</option>
                    <option value="ro">Română / Romanian (ro)</option>
                    <option value="ru">Русский / Russian (ru)</option>
                    <option value="sk">Slovensko / Slovak (sk)</option>
                    <option value="zh-cn">简体中文 / Simplified Chinese (zh-CN)</option>
                    <option value="zh">繁体中文 / Traditional Chinese (zh-TW)</option>
                </select>
                </label>

                <label>Stretching <select name="stretching">
                    <option value="auto" selected>Auto (default)</option>
                    <option value="responsive">Responsive</option>
                    <option value="fill" selected>Fill</option>
                    <option value="none" selected>None (original dimensions)</option>
                </select>
                </label>
            </form>
        </div>

        <br>

        <div id="player1-renderename"><strong>Render info</strong></div>

        <div class="commands">
            <span class="command">
                document.getElementById('player1').src = 'http://clips.vorwaerts-gmbh.de/big_buck_bunny.mp4';
            </span>
            <span class="command">
                document.getElementById('player1').src = 'https://upload.wikimedia.org/wikipedia/commons/2/22/Volcano_Lava_Sample.webm';
            </span>
            <span class="command">
                document.getElementById('player1').src = 'http://www.streambox.fr/playlists/test_001/stream.m3u8';
            </span>
            <span class="command">
                document.getElementById('player1').src = 'http://www.streambox.fr/playlists/x36xhzz/x36xhzz.m3u8';
            </span>
            <span class="command">
                document.getElementById('player1').src = 'rtmp://firehose.cul.columbia.edu:1935/vod/mp4:sample.mp4';
            </span>
            <span class="command">
                document.getElementById('player1').src = 'http://www.dailymotion.com/embed/video/x2lzodk';
            </span>
            <span class="command">
                document.getElementById('player1').src = 'https://player.vimeo.com/video/108018156?title=0&amp;byline=0&amp;portrait=0&amp;badge=0';
            </span>
            <span class="command">
                document.getElementById('player1').src = 'http://dash.edgesuite.net/envivio/EnvivioDash3/manifest.mpd';
            </span>
            <span class="command">
                document.getElementById('player1').src = 'https://www.youtube.com/watch?v=twYp6W6vt2U';
            </span>
            <span class="command">
                document.getElementById('player1').src = 'https://www.youtube.com/watch?v=9bZkp7q19f0';
            </span>
            <span class="command">
                document.getElementById('player1').src = 'http://youtu.be/xmWuqd5y77M';
            </span>
            <span class="command">
                document.getElementById('player1').src = 'https://www.facebook.com/johndyer/videos/10107816243681884/';
            </span>
            <span class="command">
                document.getElementById('player1').play();
            </span>
            <span class="command">
                document.getElementById('player1').pause();
            </span>
            <span class="command">
                document.getElementById('player1').muted = false;
            </span>
            <span class="command">
                document.getElementById('player1').muted = true;
            </span>
            <span class="command">
                document.getElementById('player1').volume = 0.5;
            </span>
            <span class="command">
                document.getElementById('player1').volume = 1;
            </span>
            <span class="command">
                document.getElementById('player1').currentTime = 26;
            </span>
        </div>

    </div><!-- /.player -->

    <div class="players" id="player2-container">


        <h3>Audio Player</h3>

        <audio id="player2" preload="none" controls>
            <source src="http://www.stephaniequinn.com/Music/Commercial%20DEMO%20-%2010.mp3" type="audio/mp3">
        </audio>

        <div id="player2-renderename"><strong>Render info</strong></div>

        <div class="commands">
            <span class="command">
                document.getElementById('player2').src = 'http://www.stephaniequinn.com/Music/Commercial%20DEMO%20-%2010.mp3'; document.getElementById('player2').load();
            </span>
            <span class="command">
                document.getElementById('player2').src = 'http://www.vorbis.com/music/Hydrate-Kenny_Beltrey.ogg'; document.getElementById('player2').load();
            </span>
            <span class="command">
                document.getElementById('player2').src = 'https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/207370321&amp;auto_play=false&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false&amp;visual=true';
            </span>
            <span class="command">
                document.getElementById('player2').src = 'rtmp://s3b78u0kbtx79q.cloudfront.net/cfx/st/mp3:fake_empire-cbr';
            </span>
            <span class="command">
                document.getElementById('player2').load();
            </span>
            <span class="command">
                document.getElementById('player2').play();
            </span>
            <span class="command">
                document.getElementById('player2').pause();
            </span>
            <span class="command">
                document.getElementById('player2').muted = false;
            </span>
            <span class="command">
                document.getElementById('player2').muted = true;
            </span>
            <span class="command">
                document.getElementById('player2').volume = 0.5;
            </span>
            <span class="command">
                document.getElementById('player2').volume = 1;
            </span>
            <span class="command">
                document.getElementById('player2').currentTime = 26;
            </span>
        </div>
    </div><!-- /.player -->

</div>  <!-- /#container -->

<script>

    function getQueryStringValue (key) {
        return decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]" + encodeURIComponent(key).replace(/[\.\+\*]/g, "\\$&") + "(?:\\=([^&]*))?)?.*$", "i"), "$1"));
    }

    // borrowed from https://gist.github.com/niyazpk/f8ac616f181f6042d1e0
    function updateUrlParameter(uri, key, value) {
        // remove the hash part before operating on the uri
        var
                i = uri.indexOf('#'),
                hash = i === -1 ? ''  : uri.substr(i)
        ;

        uri = i === -1 ? uri : uri.substr(0, i);

        var
                re = new RegExp("([?&])" + key + "=.*?(&|$)", "i"),
                separator = uri.indexOf('?') !== -1 ? "&" : "?"
        ;

        if (!value) {
            // remove key-value pair if value is empty
            uri = uri.replace(new RegExp("([?&]?)" + key + "=[^&]*", "i"), '');

            if (uri.slice(-1) === '?') {
                uri = uri.slice(0, -1);
            }
            // replace first occurrence of & by ? if no ? is present

            if (uri.indexOf('?') === -1) {
                uri = uri.replace(/&/, '?');
            }

        } else if (uri.match(re)) {
            uri = uri.replace(re, '$1' + key + "=" + value + '$2');
        } else {
            uri = uri + separator + key + "=" + value;
        }
        return uri + hash;
    }

    var
            lang = getQueryStringValue('lang') || 'en',
            stretching = getQueryStringValue('stretching') || 'auto'
    ;

    mejs.i18n.locale.language = lang;

    $('select[name=lang]').on('change', function() {
        window.location.href = updateUrlParameter(window.location.href, 'lang', $(this).val());
    }).val(lang);

    $('select[name=stretching]').on('change', function() {
        window.location.href = updateUrlParameter(window.location.href, 'stretching', $(this).val());

    }).val(stretching);

    $('video, audio').mediaelementplayer({
        stretching: stretching,
        pluginPath:'../build/',
        markers: [2.5, 10, 35, 40.2],
        features: ['playpause', 'current', 'progress','volume','speed', 'duration', 'fullscreen', 'tracks', 'skipback', 'jumpforward', 'loop', 'markers', 'stop'],

        success: function(mediaElement) {

            mejs.i18n.locale.language = mejs.i18n.getLanguage();
            $(mediaElement).closest('.mejs-container').attr('lang', mejs.i18n.getLanguage());

            var
                    container = document.getElementById(mediaElement.id + '-container'),
                    uiRendererName = document.getElementById(mediaElement.id + '-renderename')
            ;

            mediaElement.addEventListener('loadedmetadata', function(e) {

                var src = mediaElement.src;

                if (src != null) {
                    uiRendererName.innerHTML = '<strong>Render info:</strong> ' + src.substring(src.lastIndexOf('/')+1) + ' : rendered by ' + mediaElement.rendererName;
                } else {
                    uiRendererName.innerHTML = 'Error finding src. Renderer: ' + mediaElement.rendererName;
                }

            }, false);


            mediaElement.addEventListener('error', function(e) {

                uiRendererName.innerHTML = e.message;

            }, false);


            var commands = mejs.getElementsByClassName('command', container);

            console.log('commands', commands.length);

            for  (var i=0, il=commands.length; i<il; i++) {

                (function(command) {


                    mejs.addEvent(command, 'click', function() {

                        eval(command.innerHTML.replace('&amp;', '&'));

                        var parts = command.innerHTML.split('.src');
                        if (parts.length > 1) {
                            eval(parts[0] + '.load();');
                        }
                    });


                })(commands[i]);

            }
        }
    });

</script>

</body>
</html>